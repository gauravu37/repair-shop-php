import{a as ie}from"./chunk-5LCWTLC6.js";import{B as ne,b as K,c as S,d as Q,e as X,l as Y,o as Z,r as ee,y as te}from"./chunk-KU4YNCMP.js";import{A as U,Ea as J,Ga as A,Ha as W,I as R,Ja as $,La as z,Z as q,_ as O,aa as V,b as M,c as P,l as h,ya as H}from"./chunk-QPBR7IA7.js";import{Eb as s,Gb as b,Pb as o,Qb as r,Rb as u,T as w,Y as L,Yb as T,_b as x,ab as a,ba as C,cd as G,dd as j,fb as v,g as F,lc as l,ld as B,ma as I,na as y,nc as k,ob as E,ub as p,wc as N,xc as D}from"./chunk-L5V4HGA2.js";import"./chunk-Q7L6LLAK.js";var _=(()=>{class t{constructor(e,i){this.http=e,this.router=i,this.apiUrl=ie.apiUrl,this.loggedIn=new F(!1)}login(e,i){return this.http.post(`${this.apiUrl}/login.php`,{email:e,password:i}).pipe(w(n=>{n.status==="success"&&(localStorage.setItem("auth_token",n.token),localStorage.setItem("user",JSON.stringify(n.user)),this.loggedIn.next(!0))}))}isLoggedIn(){let e=localStorage.getItem("auth_token"),i=localStorage.getItem("user");return!!e&&!!i}getCurrentUser(){let e=localStorage.getItem("user");return e?JSON.parse(e):null}logout(){localStorage.removeItem("auth_token"),localStorage.removeItem("user"),this.loggedIn.next(!1),this.router.navigate(["/login"])}getToken(){return localStorage.getItem("auth_token")}getUser(){let e=localStorage.getItem("user");return e?JSON.parse(e):null}getCases(){let e=localStorage.getItem("user");return e?JSON.parse(e):null}static{this.\u0275fac=function(i){return new(i||t)(C(M),C(h))}}static{this.\u0275prov=L({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var le=()=>({"minWidth.%":44});function se(t,m){if(t&1&&(o(0,"div",24),l(1),r()),t&2){let e=x();a(),k(" ",e.error," ")}}function me(t,m){t&1&&(o(0,"small"),l(1,"Email is required"),r())}function pe(t,m){t&1&&(o(0,"small"),l(1,"Please enter a valid email"),r())}function ue(t,m){if(t&1&&(o(0,"div",25),p(1,me,2,0,"small",18)(2,pe,2,0,"small",18),r()),t&2){let e,i,n=x();a(),s("ngIf",(e=n.loginForm.get("username"))==null||e.errors==null?null:e.errors.required),a(),s("ngIf",(i=n.loginForm.get("username"))==null||i.errors==null?null:i.errors.email)}}function ce(t,m){t&1&&(o(0,"div",25)(1,"small"),l(2,"Password is required"),r()())}function de(t,m){t&1&&(o(0,"span"),l(1,"Login"),r())}function ge(t,m){t&1&&(o(0,"span"),u(1,"span",26),l(2," Loading... "),r())}var Le=(()=>{class t{constructor(e,i,n){this.fb=e,this.authService=i,this.router=n,this.loading=!1,this.error="",this.loginForm=this.fb.group({username:["",[S.required,S.email]],password:["",S.required]})}ngOnInit(){if(this.authService.isLoggedIn()){let e=this.authService.getCurrentUser();alert(e?.user_type),e?.user_type}}onSubmit(){if(this.error="",this.loading=!0,this.loginForm.invalid){this.error="Please enter valid credentials",this.loading=!1;return}let{username:e,password:i}=this.loginForm.value;this.authService.login(e,i).subscribe({next:()=>{this.loading=!1,this.router.navigate(["/dashboard"])},error:n=>{this.error=n.error?.message||"Login failed",this.loading=!1}})}static{this.\u0275fac=function(i){return new(i||t)(v(te),v(_),v(h))}}static{this.\u0275cmp=E({type:t,selectors:[["app-login"]],features:[N([_])],decls:40,vars:14,consts:[[1,"bg-light","dark:bg-transparent","min-vh-100","d-flex","flex-row","align-items-center"],["breakpoint","md"],[1,"justify-content-center"],["lg","10","xl","8"],[1,"p-4"],[3,"ngSubmit","formGroup"],[1,"text-body-secondary"],["class","alert alert-danger mb-3",4,"ngIf"],[1,"mb-3"],["cInputGroupText",""],["cIcon","","name","cilUser"],["formControlName","username","cFormControl","","placeholder","Email","type","email"],["class","text-danger mb-3",4,"ngIf"],[1,"mb-4"],["cIcon","","name","cilLockLocked"],["formControlName","password","cFormControl","","placeholder","Password","type","password"],["xs","6"],["cButton","","color","primary","type","submit",1,"px-4",3,"disabled"],[4,"ngIf"],["xs","6",1,"text-right"],["cButton","","color","link","type","button",1,"px-0"],[1,"text-white","bg-primary","py-5",3,"ngStyle"],[1,"text-center"],["cButton","","color","primary","routerLink","/register",1,"mt-3",3,"active"],[1,"alert","alert-danger","mb-3"],[1,"text-danger","mb-3"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"]],template:function(i,n){if(i&1&&(o(0,"div",0)(1,"c-container",1)(2,"c-row",2)(3,"c-col",3)(4,"c-card-group")(5,"c-card",4)(6,"c-card-body")(7,"form",5),T("ngSubmit",function(){return n.onSubmit()}),o(8,"h1"),l(9,"Login"),r(),o(10,"p",6),l(11,"Sign In to your account"),r(),p(12,se,2,1,"div",7),o(13,"c-input-group",8)(14,"span",9),I(),u(15,"svg",10),r(),y(),u(16,"input",11),r(),p(17,ue,3,2,"div",12),o(18,"c-input-group",13)(19,"span",9),I(),u(20,"svg",14),r(),y(),u(21,"input",15),r(),p(22,ce,3,0,"div",12),o(23,"c-row")(24,"c-col",16)(25,"button",17),p(26,de,2,0,"span",18)(27,ge,3,0,"span",18),r()(),o(28,"c-col",19)(29,"button",20),l(30," Forgot password? "),r()()()()()(),o(31,"c-card",21)(32,"c-card-body",22)(33,"div")(34,"h2"),l(35,"Sign up"),r(),o(36,"p"),l(37," Don't have an account? Register for a new account to access our services. "),r(),o(38,"button",23),l(39," Register Now! "),r()()()()()()()()()),i&2){let c,d,g,f;a(7),s("formGroup",n.loginForm),a(5),s("ngIf",n.error),a(4),b("is-invalid",((c=n.loginForm.get("username"))==null?null:c.invalid)&&((c=n.loginForm.get("username"))==null?null:c.touched)),a(),s("ngIf",((d=n.loginForm.get("username"))==null?null:d.invalid)&&((d=n.loginForm.get("username"))==null?null:d.touched)),a(4),b("is-invalid",((g=n.loginForm.get("password"))==null?null:g.invalid)&&((g=n.loginForm.get("password"))==null?null:g.touched)),a(),s("ngIf",((f=n.loginForm.get("password"))==null?null:f.invalid)&&((f=n.loginForm.get("password"))==null?null:f.touched)),a(3),s("disabled",n.loading),a(),s("ngIf",!n.loading),a(),s("ngIf",n.loading),a(4),s("ngStyle",D(13,le)),a(7),s("active",!0)}},dependencies:[B,G,j,P,W,z,$,V,q,O,H,A,U,J,R,ne,Y,K,Q,X,Z,ee],encapsulation:2})}}return t})();export{Le as LoginComponent};
