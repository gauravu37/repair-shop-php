import{a as z}from"./chunk-2FK3AD3G.js";import{B as V,b as D,c as C,d as Q,e as R,l as U,o as T,r as B,y as j}from"./chunk-U632TBKN.js";import{$ as x,Ba as L,Fa as E,J as F,_ as I,b as P,ca as N,m as w,wb as q}from"./chunk-52S2453R.js";import{Eb as a,I as d,Pb as r,Qb as o,Rb as m,Y as b,Yb as u,Za as h,_b as S,ab as l,ba as _,fb as c,lc as s,ob as y,ub as v}from"./chunk-PZC2ALTS.js";import"./chunk-Q7L6LLAK.js";var G=(()=>{class i{constructor(e){this.http=e,this.apiUrl=`${z.apiUrl}/settings.php`}getSettings(){return this.http.get(this.apiUrl)}updateSettings(e){return this.http.put(this.apiUrl,e)}uploadImage(e){return this.http.post(`${this.apiUrl}/upload`,e)}static{this.\u0275fac=function(n){return new(n||i)(_(P))}}static{this.\u0275prov=b({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();function H(i,g){if(i&1&&m(0,"img",16),i&2){let e=S();a("src",e.logoPreview||"./assets/default-logo.png",h)}}function $(i,g){i&1&&m(0,"c-spinner")}function k(i,g){if(i&1&&m(0,"img",17),i&2){let e=S();a("src",e.qrCodePreview||"./assets/default-qr.png",h)}}function O(i,g){i&1&&m(0,"c-spinner")}var te=(()=>{class i{constructor(e,n,t){this.fb=e,this.settingsService=n,this.router=t,this.logoPreview=null,this.qrCodePreview=null,this.uploadingLogo=!1,this.uploadingQrCode=!1,this.uploading=!1,this.settingsForm=this.fb.group({businessName:["",C.required],contactNumber:["",C.required],logoPath:[""],qrCodePath:[""]})}ngOnInit(){this.loadSettings()}loadSettings(){this.settingsService.getSettings().subscribe(e=>{this.currentSettings=e,this.settingsForm.patchValue(e),e.logoPath&&(this.logoPreview=e.logoPath),e.qrCodePath&&(this.qrCodePreview=e.qrCodePath)})}onLogoSelected(e){let n=e.target.files[0];if(n){this.uploadingLogo=!0;let t=new FileReader;t.readAsDataURL(n),t.onload=()=>{this.logoPreview=t.result,this.uploadImage(n,"logo").pipe(d(()=>this.uploadingLogo=!1)).subscribe(p=>{this.settingsForm.patchValue({logoPath:p.path})})}}}onQrCodeSelected(e){let n=e.target.files[0];if(n){this.uploadingQrCode=!0;let t=new FileReader;t.readAsDataURL(n),t.onload=()=>{this.qrCodePreview=t.result,this.uploadImage(n,"qrcode").pipe(d(()=>this.uploadingQrCode=!1)).subscribe(p=>{this.settingsForm.patchValue({qrCodePath:p.path})})}}}uploadImage(e,n){let t=new FormData;return t.append("file",e),t.append("type",n),this.settingsService.uploadImage(t)}onSubmit(){this.settingsForm.valid&&(this.uploading=!0,this.settingsService.updateSettings(this.settingsForm.value).pipe(d(()=>this.uploading=!1)).subscribe({next:()=>alert("Settings saved successfully!"),error:e=>alert("Error saving settings: "+e.message)}))}static{this.\u0275fac=function(n){return new(n||i)(c(j),c(G),c(w))}}static{this.\u0275cmp=y({type:i,selectors:[["app-settings"]],decls:38,vars:6,consts:[[3,"ngSubmit","formGroup"],[1,"mb-4"],["cLabel",""],[1,"d-flex","align-items-center"],[1,"me-3"],["alt","Logo Preview","class","img-thumbnail","width","150",3,"src",4,"ngIf"],[4,"ngIf"],["type","file","accept","image/*",1,"form-control",3,"change"],[1,"text-muted"],["alt","QR Code Preview","class","img-thumbnail","width","150",3,"src",4,"ngIf"],[1,"mb-3"],["cLabel","","for","businessName"],["type","text","cFormControl","","id","businessName","formControlName","businessName"],["cLabel","","for","contactNumber"],["type","text","cFormControl","","id","contactNumber","formControlName","contactNumber"],["cButton","","color","primary","type","submit",3,"disabled"],["alt","Logo Preview","width","150",1,"img-thumbnail",3,"src"],["alt","QR Code Preview","width","150",1,"img-thumbnail",3,"src"]],template:function(n,t){n&1&&(r(0,"c-card")(1,"c-card-header")(2,"h5"),s(3,"Business Settings"),o()(),r(4,"c-card-body")(5,"form",0),u("ngSubmit",function(){return t.onSubmit()}),r(6,"div",1)(7,"label",2),s(8,"Business Logo"),o(),r(9,"div",3)(10,"div",4),v(11,H,1,1,"img",5)(12,$,1,0,"c-spinner",6),o(),r(13,"div")(14,"input",7),u("change",function(f){return t.onLogoSelected(f)}),o(),r(15,"small",8),s(16,"Recommended size: 300x100 pixels"),o()()()(),r(17,"div",1)(18,"label",2),s(19,"Payment QR Code"),o(),r(20,"div",3)(21,"div",4),v(22,k,1,1,"img",9)(23,O,1,0,"c-spinner",6),o(),r(24,"div")(25,"input",7),u("change",function(f){return t.onQrCodeSelected(f)}),o(),r(26,"small",8),s(27,"Upload payment QR code (UPI, PayPal, etc.)"),o()()()(),r(28,"div",10)(29,"label",11),s(30,"Business Name"),o(),m(31,"input",12),o(),r(32,"div",10)(33,"label",13),s(34,"Contact Number"),o(),m(35,"input",14),o(),r(36,"button",15),s(37," Save Settings "),o()()()()),n&2&&(l(5),a("formGroup",t.settingsForm),l(6),a("ngIf",!t.uploadingLogo),l(),a("ngIf",t.uploadingLogo),l(10),a("ngIf",!t.uploadingQrCode),l(),a("ngIf",t.uploadingQrCode),l(13),a("disabled",t.settingsForm.invalid||t.uploading))},dependencies:[I,N,x,E,L,F,q,V,U,D,Q,R,T,B],encapsulation:2})}}return i})();export{te as SettingsComponent};
